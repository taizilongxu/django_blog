<p>title: python-cookbook<br>
date: 2014-04-04 12:36:26<br>
category: python-cookbook</p>

<h2>tags: [python,python-cookbook]</h2>

<h1>第一章 文本</h1>

<h2>1.1每次处理一个字符</h2>
<div class="highlight"><pre><span class="mf">1.</span> <span class="n">thelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">thestring</span><span class="p">)</span>
     <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tehstring</span><span class="p">:</span>
        <span class="n">do_something_with</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="mf">2.</span> <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">do_something_with</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">thestring</span><span class="p">]</span> 
<span class="mf">3.</span> <span class="n">results</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">do_something</span><span class="p">,</span><span class="n">thestring</span><span class="p">)</span>
</pre></div>

<h2>1.2字符和字符值之间的转换</h2>

<p>将一个字符转化为相应的ASC或Unicode</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span> <span class="mi">97</span> <span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">91</span><span class="p">)</span>
<span class="n">a</span>

<span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="nb">ord</span><span class="p">(</span><span class="s">u&#39;</span><span class="se">\u2020</span><span class="s">&#39;</span><span class="p">)</span>
<span class="mi">8224</span> 
<span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">unichr</span><span class="p">(</span><span class="mi">8224</span><span class="p">))</span>
<span class="s">u&#39;</span><span class="se">\u2020</span><span class="s">&#39;</span>
</pre></div>

<h2>1.3测试一个对象是否是类字符串</h2>
<div class="highlight"><pre><span class="nb">isinstance</span> <span class="err">和</span> <span class="nb">basestring</span>
<span class="nb">basestring</span><span class="err">是</span><span class="nb">str</span> <span class="err">和</span><span class="nb">unicode</span><span class="err">的共同基类</span>

<span class="k">def</span> <span class="nf">isAString</span><span class="p">(</span><span class="n">anobj</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anobj</span><span class="p">,</span><span class="nb">basestring</span><span class="p">)</span>
</pre></div>

<h2>1.4字符串对齐</h2>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="s">&#39;|&#39;</span><span class="p">,</span><span class="s">&#39;hej&#39;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="s">&#39;|&#39;</span><span class="p">,</span><span class="s">&#39;hej&#39;</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="s">&#39;|&#39;</span><span class="p">,</span><span class="s">&#39;hej&#39;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="s">&#39;|&#39;</span>
 <span class="o">|</span><span class="n">hej</span>                  <span class="o">|</span>                  <span class="n">hej</span> <span class="o">|</span>         <span class="n">hej</span>          <span class="o">|</span>
</pre></div>

<h2>1.5去掉字符串两端的空格</h2>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="n">x</span> <span class="o">=</span> <span class="s">&#39;    hej    &#39;</span> <span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="s">&#39;|&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(),</span><span class="s">&#39;|&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span><span class="s">&#39;|&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="s">&#39;|&#39;</span>
 <span class="o">|</span> <span class="n">hej</span>     <span class="o">|</span>     <span class="n">hej</span> <span class="o">|</span> <span class="n">hej</span> <span class="o">|</span>
</pre></div>

<h2>1.6合并字符串</h2>

<p>1.大量字符优先,可以用中间数据list来容纳后来的字符，最后再一并处理</p>
<pre><code>largeString = ''.join(pieces)</code></pre>
<p>2.少量字符优先</p>
<pre><code>largeString = '%s%s something %s yet more' % (small1,small2,small3)</code></pre>
<p>3.效率低下，会产生许多字符串的中间结果</p>
<pre><code>largeString = small1 + small2 + 'something' + small3 + 'yet more' 4. import operator
largeString = reduce(operator.add,pieces,'')</code></pre>
<h2>1.7将字符串逐个字符或逐个词进行反转</h2>

<p>1.字符，切片方法</p>
<pre><code>revchars = astring[::-1]</code></pre>
<p>2.单词</p>
<div class="highlight"><pre><span class="n">revwords</span> <span class="o">=</span> <span class="n">astring</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">revwords</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="n">revwords</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">revwords</span><span class="p">)</span>

    <span class="n">revwords</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">astring</span><span class="o">.</span><span class="n">split</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

<p>reversed返回一个迭代器 </p>

<h2>1.8检查字符中是否包含某字符集合中的字符</h2>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">containsAny</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="n">aset</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">aset</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">c</span> <span class="n">inaset</span><span class="p">:</span> <span class="k">return</span> <span class="bp">True</span> 
    <span class="k">return</span> <span class="bp">False</span>
</pre></div>

<h2>1.9简化字符串的translate方法的使用</h2>

<h2>1.10过滤字符串中不属于指定集合的字符（translate）</h2>

<p><strong>Perl的判定方法，如果字符串中包含了空值或者其中有超过30%的字符的高位被置为1或是奇怪的控制码，我们就认为这段数据是二进制数据</strong></p>

<h2>1.12控制大小写</h2>

<p>big = little.upper()<br>
little = big.lower()</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="s">&#39;one tWo thrEe&#39;</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<span class="n">One</span> <span class="n">two</span> <span class="n">three</span>

<span class="o">&gt;&gt;&gt;</span><span class="k">print</span> <span class="s">&#39;one tWo threEe&#39;</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
<span class="n">One</span> <span class="n">Two</span> <span class="n">Threee</span>
</pre></div>

<h2>1.13访问子字符串</h2>

<p>1.切片方式</p>
<pre><code>afield = theline[3:8]</code></pre>
<p>2.struct.unpack方法</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">struct</span>
<span class="n">format</span> <span class="o">=</span> <span class="s">&#39;5s 4x 3s&#39;</span>
<span class="c">#取前5个字符，跳过4个字符，再取3个字符</span>
<span class="k">print</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="s">&#39;Test astring&#39;</span><span class="p">))</span>

<span class="err">结果</span><span class="p">:</span> <span class="n">Testing</span>
</pre></div>

<h2>1.14改变多行文本字符串的缩进</h2>

<p>1.统一的缩进</p>
<div class="highlight"><pre><span class="n">defa</span> <span class="n">reindent</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">numSpace</span><span class="p">):</span>
    <span class="n">leading_space</span> <span class="o">=</span> <span class="n">numSpaces</span> <span class="o">*</span> <span class="s">&#39; &#39;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">leading_space</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">strio</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()]</span>
    <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</pre></div>

<p>2.相对缩进</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">addSpaces</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">numAdd</span><span class="p">):</span>
    <span class="n">white</span> <span class="o">=</span> <span class="s">&quot; &quot;</span> <span class="o">*</span> <span class="n">numAdd</span>
    <span class="k">return</span> <span class="n">white</span> <span class="o">+</span> <span class="n">white</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="bp">True</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">numSpaces</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()]</span>
<span class="k">def</span> <span class="nf">delSpaces</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">numDel</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">numDel</span> <span class="o">&gt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">numSpaces</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">,</span><span class="s">&quot;removing more spaces than there are!&quot;</span>
    <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="n">numDel</span><span class="p">:]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()])</span>
</pre></div>

<p>3.让缩进最小的行与左端对齐</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">unIndentBlock</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">delSpaces</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">numSpaces</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
</pre></div>
